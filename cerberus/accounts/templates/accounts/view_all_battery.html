{% extends 'menu.html' %}
{% load static %}
{% block head %}
    <title>BATTERIES | Cerberus</title>
    <link rel="stylesheet" href="{% static 'accounts/css/base.css' %}">
{% endblock head %}


{% block menu %}
   <div class="row p-5 bg-white">
      <div class="col-md-6">
      </div>
      <div class="col-md-6">
         <form method="post" id="view-battery-search-form">
            {% csrf_token %}
            <div class="input-group mb-3">
               <input type="text" class="form-control" id="view-battery-search-bar" placeholder="Enter Battey pack serial no..." aria-label="Search" aria-describedby="search-addon" name="search_text"/>
               
               <button type="submit" class="btn btn-outline-secondary" id="view-battery-search-button">
                  search
               </button> 
            </div>
         </form>
      </div>
   </div>
   <div class="row px-5 bg-white">
      <div class="col-md-12">
         <h3>Batteries Data</h3>
         <table  class="mt-3 table caption-top table-responsive">
            <thead>
               <tr>
                  <th scope="col">Battery_Serial_Number</th>
                  <th scope="col">Model_Name</th>
                  <th scope="col">Assigned_owner</th>
                  <th scope="col">IOT_IMEI_No</th>
                  <th scope="col">Battery_type</th>
                  <th scope="col">BMS_type</th>
                  <th scope="col">IOT_type</th>
                  <th scope="col">Sim_Number</th>
                  <th scope="col">Warranty_Start_Date</th>
                  <th scope="col">Warrenty_End_Date</th>
                  <th scope="col">Status</th>
                  <th scope="col">Battery_Cell_Chemistry</th>
                  <th scope="col">Battery_pack_Nominal_Voltage</th>
                  <th scope="col">Battery_Pack_Capacity</th>
                  <th scope="col">Battery_Cell_Type</th>
                  <th scope="col">Immobilisation_Status</th>
                  <th scope="col">SOC</th>
                  <th scope="col">Action</th>
               </tr>
            </thead>
            <tbody> 

               {% for tag in battery_data %} 
               
               <tr>
                  <td>
                     {% if tag.Battery_Serial_Number %}
                        {{ tag.Battery_Serial_Number}}
                     {% else %}
                        -
                     {% endif %}
                  </td>
                  <td>
                     {% if tag.Model_Name %}
                        {{tag.Model_Name}}
                     {% else %}
                        -
                     {% endif %}
                  </td>
                  <td>
                     {% if tag.Assigned_owner %}
                        {{tag.Assigned_owner}}
                     {% else %}
                        -
                     {% endif %}
                  </td>
                  <td>
                     {% if tag.IOT_IMEI_No %}
                        {{tag.IOT_IMEI_No}}
                     {% else %}
                        -
                     {% endif %}
                  </td>
                  <td>
                     {% if tag.Battery_type %}
                        {{tag.Battery_type}}
                     {% else %}
                        -
                     {% endif %}
                  </td>
                  <td>
                     {% if tag.BMS_type %}
                        {{tag.BMS_type}}
                     {% else %}
                        -
                     {% endif %}
                  </td>
                  <td>
                     {% if tag.IOT_type %}
                        {{tag.IOT_type}}
                     {% else %}
                        -
                     {% endif %}
                  </td>
                  <td>
                     {% if tag.Sim_Number %}
                        {{tag.Sim_Number}}
                     {% else %}
                        -
                     {% endif %}
                  </td>
                  <td>
                     {% if tag.Warranty_Start_Date %}
                        {{tag.Warranty_Start_Date}}
                     {% else %}
                        -
                     {% endif %}
                  </td>
                  <td>
                     {% if tag.Warranty_End_Date %}
                        {{tag.Warranty_End_Date}}
                     {% else %}
                        -
                     {% endif %}
                  </td>
                  <td>
                     {% if tag.Status %}
                        {{tag.Status}}
                     {% else %}
                        -
                     {% endif %}
                  </td>
                  <td>
                     {% if tag.Battery_Cell_Chemistry %}
                        {{tag.Battery_Cell_Chemistry}}
                     {% else %}
                        -
                     {% endif %}
                  </td>
                  <td>
                     {% if tag.Battery_pack_Nominal_Voltage %}
                        {{tag.Battery_pack_Nominal_Voltage}}
                     {% else %}
                        -
                     {% endif %}
                  </td>
                  <td>
                     {% if tag.Battery_Pack_Capacity %}
                        {{tag.Battery_Pack_Capacity}}
                     {% else %}
                        -
                     {% endif %}
                  </td>
                  <th>
                     {% if tag.Battery_Cell_Type %}
                        {{tag.Battery_Cell_Type}}
                     {% else %}
                        -
                     {% endif %}
                  </th>
                  <th>
                     <div class="input-group">
                        {% if tag.Immobilisation_Status and tag.Immobilisation_Status == "0" %}
                           <div class="form-check form-switch">
                              <input class="form-check-input" type="checkbox" id="moblisation_status" checked>
                           </div>
                        {% else %}
                           <div class="form-check form-switch">
                              <input class="form-check-input" type="checkbox" id="moblisation_status">
                           </div>
                        {% endif %}
                        <button class="btn btn-default" type="reset">
                           <img class="action_btn" src="{% static 'accounts/images/action_btns/redo.png' %}">
                        </button>
                     </div>
                  </th>
                  <th>
                     {% if tag.SoC %}
                        {{ tag.SoC }}
                     {% else %}
                        -
                     {% endif %}
                  </th>
                  <td>
                     <div class="btn-group">
                        <a href="{% url 'update_battery' tag.Battery_Serial_Number %}" class="btn btn-light btn-sm"><img class="action_btn" src="{% static 'accounts/images/action_btns/edit.svg' %}" alt="edit.svg"></a>
                        <a class="btn btn-light btn-sm" id = "delete_btn" data-model_name = "{{ tag.Model_Name }}" data-battery_serial_number = "{{ tag.Battery_Serial_Number }}"><img class="action_btn" src="{% static 'accounts/images/action_btns/delete.svg' %}" alt="delete.svg"></button>
                        <a href="{% url 'allocatebattery' tag.Battery_Serial_Number %}" class="btn btn-light btn-sm"><img class="action_btn" src="{% static 'accounts/images/action_btns/electric_vehicle.svg' %}" alt="edit.svg"></a>
                        <a href="#" class="btn btn-light btn-sm"><img class="action_btn" src="{% static 'accounts/images/action_btns/data-update.svg' %}" alt="data-update.svg"></a>
                        <a href="{% url 'logs' tag.Battery_Serial_Number %}" class="btn btn-light btn-sm"><img class="action_btn" src="{% static 'accounts/images/action_btns/log12-removebg-preview.png' %}" alt="log12-removebg-preview.svg"></a>
                     </div>
                  </td> 
               </tr>

               <div class="modal" tabindex="-1" id="delete_modal">
                  <div class="modal-dialog">
                        <div class="modal-content">
                           <div class="modal-header">
                              <h5 class="modal-title">Delete Battery <span id="model_name"></span></h5>
                              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                           </div>
                           <div class="modal-body">
                              <p>Are You sure to delete Battery <span id="model_name_msg"></span></p>
                           </div>
                           <div class="modal-footer">
                              <form method="post">
                                    {% csrf_token %}
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                    <button type="submit" class="btn btn-danger" id = "delete_battery">Yes, Delete</button>
                              </form>
                           </div>
                        </div>
                  </div>
               </div>
               {% endfor %}
            </tbody>
         </table>
      </div>
   </div>

   

{% endblock menu %}   